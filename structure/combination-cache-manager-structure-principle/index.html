<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.73.0" />
    <meta name="description" content="KeJyun Laravel 學習筆記">
<meta name="author" content="KeJyun">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Combination &amp; Cache 架構設計準則（2019 年版本） :: Laravel 學習筆記</title>

    
    <link href="https://laravel5-book.kejyun.com/css/nucleus.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/fontawesome-all.min.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/hybrid.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/featherlight.min.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/perfect-scrollbar.min.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/auto-complete.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/atom-one-dark-reasonable.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/theme.css?1615475347" rel="stylesheet">
    <link href="https://laravel5-book.kejyun.com/css/hugo-theme.css?1615475347" rel="stylesheet">
    
    <link href="https://laravel5-book.kejyun.com/css/theme-mine.css?1615475347" rel="stylesheet">
    
    

    <script src="https://laravel5-book.kejyun.com/js/jquery-3.3.1.min.js?1615475347"></script>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    <style type="text/css">
    #chapter p {
      text-align:left;
    }
</style>




  
    

<script type="application/ld+json">
{
    "@context":"http://schema.org",
    "@type":"Article",
    "headline":"Combination \u0026 Cache 架構設計準則（2019 年版本）",
    "url":"https:\/\/laravel5-book.kejyun.com\/structure\/combination-cache-manager-structure-principle\/",
    "keywords":[
    
      
        
        "laravel"
      
        , 
        "laravel 學習筆記"
      
        , 
        "KJ"
      
        , 
        "kejyun"
      
    
    ],
    "image":{
        "@type":"ImageObject",
        "url" :
        
          "https:\/\/laravel5-book.kejyun.com\/images\/logo.jpeg",
        
        "width":"1200",
        "height":"627"
    },
    "mainEntityOfPage":"True",
    "publisher":{
        "@type":"Organization",
        "name":"KeJyun",
        "url":"https:\/\/laravel5-book.kejyun.com\/",
        "logo":{
            "@type":"ImageObject",
            "url":"https:\/\/laravel5-book.kejyun.com\/images\/logo.jpeg",
            "width":"357",
            "height":"60"
        }
    },
    "dateCreated":"2020-06-30T21:24:42\u002b08:00",
    "datePublished":"2020-06-30T21:24:42\u002b08:00",
    
    
    "author":"KJ",
    "creator":"KJ",
    
    "dateModified":"2020-06-30T21:24:42\u002b08:00",
    "articleSection":"TechArticle"
}
</script>

  

  
    
<script type="application/ld+json">
	{
		"@context":"http://schema.org",
		"@type": "BlogPosting",
		"image":
		
			"https:\/\/laravel5-book.kejyun.com\/images\/logo.jpeg",
		
		"url": "https:\/\/laravel5-book.kejyun.com\/structure\/combination-cache-manager-structure-principle\/",
		"headline": "Combination \u0026 Cache 架構設計準則（2019 年版本）",
		"alternativeHeadline": "Combination \u0026 Cache 架構設計準則（2019 年版本）",
		"dateCreated": "2020-06-30T21:24:42\u002b08:00",
		"datePublished": "2020-06-30T21:24:42\u002b08:00",
		"dateModified": "2020-06-30T21:24:42\u002b08:00",
		"inLanguage": "zh-TW",
		"isFamilyFriendly": "true",
		"copyrightYear": "2020",
		"copyrightHolder": "KeJyun",
		"contentLocation": {
			"@type": "Place",
			"name": ""
		},
		
		"accountablePerson": {
			"@type": "Person",
			"name": "KJ",
			"url": "https:\/\/laravel5-book.kejyun.com\/"
		},
		"author": {
			"@type": "Person",
			"name": "KJ",
			"url": "https:\/\/laravel5-book.kejyun.com\/"
		},
		"creator": {
			"@type": "Person",
			"name": "KJ",
			"url": "https:\/\/laravel5-book.kejyun.com\/"
		},
		
		"publisher": {
			"@type": "Organization",
			"name": "KeJyun",
			"url": "https:\/\/laravel5-book.kejyun.com\/",
			"logo": {
				"@type": "ImageObject",
				"url": "https:\/\/laravel5-book.kejyun.com\/images\/logo.jpeg",
				"width":"357",
				"height":"60"
			}
		},
		"mainEntityOfPage": "True",
		"keywords": [ 
			"laravel", "laravel 學習筆記", "KJ", "kejyun"
		],
		"genre":["KeJyun"],
		"articleSection": "KeJyun",
		"articleBody": "Combination \u0026amp; Cache 架構設計準則（2019 年版本） 傳統的 MVC（Model, View, Controller） 框架，當 Controller 收到請求之後，我們會在 Controller 內直接透過 Model 去撈取資料庫的資料，並在 Controller 做資料驗證、資料整合、快取、商業邏輯判斷\u0026hellip;等等的工作。\n當系統越來越大，會發現很多類似的商業邏輯的程式都散在各地，沒有辦法重複再利用，當程式需要異動或修改的時候，就要去搜尋所有程式碼，把許多相同商業邏輯的程式碼去做異動，但需要修改的地方若太多，往往會東漏西漏，導致系統出現錯誤，並造成往後開發的時間成本增加。\n所以我們會想要做到 減少重複的程式碼、提高維護開發的效率，所以將程式碼依照分類及分層抽出獨立控管，讓不同類型的程式專心處理自己相關的商業邏輯，讓開發維護更容易。\n隨著程式架構的演進會發展出更多不同的架構，所以這個設計架構準則也是會隨著時間做演進的。\n 資料處理邏輯分層 架構圖 架構說明 A. 資料控制結構 * Controller (控制器：控制資料流程) * ServiceManager (服務整合管理：組合管理不同 Service 的商業邏輯) * Service (服務：處理商業邏輯) * Repository (資源庫：資料表資料撈取邏輯) * Model (資料庫模型：資料表設定) * Presenter (資料呈現：資料表資料格式呈現轉換) * Combination（資料整合：整理 Repository 資料成資訊） * CombinationManager（複合資料整合管理：整理多個 Service 的資料成資訊） * Checker (檢查器：根據 Controller 所需商業邏輯，驗證不同資料表欄位資料) * Validator (驗證器：資料表欄位資料驗證)    結構名稱 說明     Controller (控制器) 控制資料流程，控制要使用哪些 Service 或 ServiceManager 的商業邏輯，去組合出使用者請求需要的資料，並做資料的資料交易控制 (transaction) ，並使用 Checker 去檢查任何使用者傳進來的資料，確保資料的正確性   ServiceManager (服務整合管理) 協助 Controller 組合不同 Service 的資料成商業邏輯   Service (服務) 處理商業邏輯，組合不同的 Repository 資料成商業邏輯，提供 Controller 或 ServiceManager 存取   Repository (資源庫) 資料表資料撈取邏輯，撈取屬於自己 Model 不同條件下的資料，提供 Service 存取   Model (資料庫模型) 資料庫模型，資料表存取相關設定   Presenter (資料呈現) 資料呈現，協助 Model 做資料呈現轉換   Checker (檢查器) 協助 Controller 做資料驗證，在資料進入到程式邏輯前，都需要經過 Checker 將資料格式做驗證   Validator (驗證器) 協助 Checker 做資料驗證，Validator 只能驗證單一 Model 資料   CombinationManager (複合資料整合管理) 協助整理不同 Service 的複合式資料，若有資料的邏輯判斷需要不同的資料來源，則由 CombinationManager 負責整合處理   Combination （資料整合） 協助整理 Repository 資料成資訊    B.獨立結構 * CacheManager (快取：管理資源快取鍵值及清除快取) * Constant (常數：定義資料狀態名稱) * Support (支援：協助處理獨立邏輯資料處理) * ExceptionCode (例外代碼：例外錯誤代碼定義)    結構名稱 說明     CacheManager (快取) 協助專案資料做快取資料的控制，可以在任何程式邏輯複雜的地方做快取存取控制，並統一清除快取   Constant (常數) 定義並命名所有資料狀態，確保資料值做異動時，不會影響程式邏輯   Support (支援) 協助處理獨立程式邏輯，邏輯沒有被其他任何的函式綁定，可以獨立完成   ExceptionCode (例外代碼) 定義例外代碼，可以統一管控當例外發生錯誤時，回傳的錯誤代碼     架構存取限制  不能跨 2 階層以上存取  Controller 不能存取 Repository Controller 不能存取 Validator Service 不能存取 Model   低階層的不能存取高階層的資料  Model 不能存取 Repository Repository 不能存取 Service Validator 不能存取 Checker   同一個資料類型，不能互相呼叫  避免同一類型類別呼叫，造成 new 物件的時候有無窮迴圈  PostService 存取 UserService，UserService 存取 PostsService 造成無窮迴圈   ServiceManager 不能呼叫 ServiceManager Service 不能呼叫 Service Checker 不能呼叫 Checker Validator 不能呼叫 Validator Repository 不能呼叫 Repository CacheManager 不能呼叫 CacheManager   獨立結構可以在任何一階層去呼叫   架構設計邏輯範例說明 A. 資料控制結構 Controller (控制器)    項目 說明     用途 控制資料流程   可以存取結構 Checker、ServiceManager、Service、DB transaction，所有獨立結構   可以被存取結構 無    處理 HTTP 請求的入口，依照需求呼叫 ServiceManager 或 Service 去做資料的存取，大部分情況呼叫 Service 去組合需要的資料就好，若相同的組合邏輯在不同的 Controller 都有用到，那就使用 ServiceManager 去組合不同的 Service\n要確保所有 Service 商業邏輯都正確跑完才允許對資料做異動，並避免 Transaction 在 Controller 及 Service 被重複呼叫，導致無法正確鎖定資料狀態，所以使用 Controller 當作資料交易（Transaction）的控制點\n\u0026lt;?php class PostController extends Controller { public function __construct( PostServiceManager $PostServiceManager, PostService $PostService, CommentService $CommentService, PostChecker $PostChecker ) { $this-\u0026gt;PostServiceManager = $PostServiceManager; $this-\u0026gt;PostService = $PostService; $this-\u0026gt;CommentService = $CommentService; $this-\u0026gt;PostChecker = $PostChecker; } \/\/ 顯示文章  public function show($post_id) { try { \/\/ 驗證資料  $input = [ \u0026#39;post_id\u0026#39; =\u0026gt; $post_id ]; $this-\u0026gt;PostChecker-\u0026gt;checkShow($input); \/\/ 撈取文章  $Post = $this-\u0026gt;PostServiceManager-\u0026gt;findPost($post_id); \/\/ 撈取文章留言  $Comment = $this-\u0026gt;CommentService-\u0026gt;getCommentByPostId(post_id); } catch (Exception $exception) { throw $exception } } \/\/ 更新文章  public function update($post_id) { try { \/\/ 驗證資料  $input = request()-\u0026gt;all(); $input[\u0026#39;post_id\u0026#39;] = $post_id; $this-\u0026gt;PostChecker-\u0026gt;checkUpdate($input); \/\/ 交易開始  DB::beginTransaction(); \/\/ 更新文章  $Post = $this-\u0026gt;PostService-\u0026gt;update($post_id, $input); \/\/ 交易結束  DB::commit(); } catch (Exception $exception) { \/\/ 交易失敗  DB::rollBack(); throw $exception } } }  ServiceManager (服務整合管理)    項目 說明     用途 組合管理不同 Service 的商業邏輯   可以存取結構 Service、所有獨立結構   可以被存取結構 Controller    使用不同 Service 撈取資料，將不同資料組合成商業邏輯，供 Controller 做存取\n\u0026lt;?php class PostServiceManager { public function __construct( PostService $PostService, UserService $UserService ) { $this-\u0026gt;PostService = $PostService; $this-\u0026gt;UserService = $UserService; } \/\/ 撈取文章資料  public function findPost($post_id){ try { \/\/ 撈取文章  $Post = $this-\u0026gt;PostService-\u0026gt;findPost($post_id); \/\/ 撈取文章作者資料  $user_id = $Post-\u0026gt;user_id; $Post-\u0026gt;user = $this-\u0026gt;UserService-\u0026gt;findUser($user_id); return $Post; } catch (Exception $exception) { throw $exception } } } Service (服務)    項目 說明     用途 處理商業邏輯   可以存取結構 Repository、所有獨立結構   可以被存取結構 Controller、ServiceManager    使用不同的 Repository 撈取資料，將不同資料組合成商業邏輯\n\u0026lt;?php class PostService { public function __construct( PostRepository $PostRepository, PostTagRepository $PostTagRepository ) { $this-\u0026gt;PostRepository = $PostRepository; $this-\u0026gt;PostTagRepository = $PostTagRepository; } \/\/ 撈取文章  public function findPost($post_id) { try { \/\/ 撈取文章  $Post = $this-\u0026gt;PostRepository-\u0026gt;find($post_id); \/\/ 撈取文章標籤  $Tag = $this-\u0026gt;PostTagRepository-\u0026gt;getByPostId($post_id); return [$Post, $Tag]; } catch (Exception $exception) { throw $exception } } }  Repository (資源庫)    項目 說明     用途 資料表資料撈取邏輯   可以存取結構 Model、所有獨立結構   可以被存取結構 Service    撈取特定 Model 資料，像 PostRepository 可以存取 Post Model (模型) 的 基本資料，並使用不同條件撈取 Model 的資料，供 Service 做存取\n也可以使用 PostRecommendRepository 存取 Post Model (模型) 的 推薦資料\n同一個 Model (模型) 可以用不同的 Repository 去呼叫，但同一 Repository 只能有一個 Model (模型)\n\u0026lt;?php class PostRepository { public function __construct( Post $Post ) { $this-\u0026gt;Post = $Post; } public function find($post_id) { try { \/\/ 撈取資料庫文章資料  $Post = $this-\u0026gt;Post-\u0026gt;find($post_id); return $Post; } catch (Exception $exception) { throw $exception } } public function findLatestPost() { try { \/\/ 撈取資料庫文章資料  $Post = $this-\u0026gt;Post -\u0026gt;order(\u0026#39;created_at\u0026#39;, \u0026#39;desc\u0026#39;) -\u0026gt;first(); return $Post; } catch (Exception $exception) { throw $exception } } } Model (資料庫模型)    項目 說明     用途 資料表設定   可以存取結構 所有獨立結構   可以被存取結構 Repository    Eloquent 存取資料表相關設定，使用 Eloquent 直接存取資料表資料\n\u0026lt;?php class Post extends Model { protected $table = \u0026#39;post\u0026#39;; protected $fillable = []; protected $primaryKey = \u0026#39;id\u0026#39;; protected $dates = [\u0026#39;created_at\u0026#39;, \u0026#39;updated_at\u0026#39;]; protected $presenter = PostPresenter::class; }  Presenter (資料呈現)    項目 說明     用途 資料表資料格式呈現轉換   可以存取結構 所有獨立結構   可以被存取結構 Model    提供 Model 的資料用其他方式呈現\n\u0026lt;?php class PostPresenter extends Presenter { public function created_at_human_time() { return $this-\u0026gt;created_at-\u0026gt;diffForHumans(); } } Checker (檢查器)    項目 說明     用途 根據 Controller 所需商業邏輯，驗證不同資料表欄位資料   可以存取結構 Validator、所有獨立結構   可以被存取結構 Controller    協助 Controller 驗證不同資料表資料的正確性，若驗證錯誤則丟處例外，Controller 根據例外代碼去做處理\n\u0026lt;?php class PostValidator { public function checkFindPost($input){ \/\/ 驗證文章資料  $this-\u0026gt;PostValidator-\u0026gt;validatePostId($input); $this-\u0026gt;PostValidator-\u0026gt;validatePostContent($input); \/\/ 驗證會員資料  $this-\u0026gt;MemberValidator-\u0026gt;validateMemberId($input); } } Validator (驗證器)    項目 說明     用途 資料表欄位資料驗證   可以存取結構 所有獨立結構   可以被存取結構 Checker    協助 Checker 驗證資料的正確性，若驗證錯誤則丟處例外，Checker 根據例外代碼去做處理\n\u0026lt;?php class PostValidator { public function validatePostId($input){ \/\/ 設定驗證規則  $rules = [ \u0026#39;post_id\u0026#39; =\u0026gt; [ \u0026#39;required\u0026#39;, \u0026#39;max:20\u0026#39;, ], ]; \/\/ 開始驗證  $this-\u0026gt;validator = Validator::make($input, $rules); if ($this-\u0026gt;validator-\u0026gt;fails()) { throw new Exception( \u0026#39;文章編號格式錯誤\u0026#39;, PostExceptionCode::POST_ID_FORMAT_ERROR ); } } }  Combination（資料整合）    項目 說明     用途 整理 Repository 資料成資訊   可以存取結構 所有獨立結構   可以被存取結構 Serivce、CombinationManager    當 Service 從 Repository 取得資料後，協助整理判斷 Repository 資料的屬性狀態，像是可以從 文章編號 取得 文章網址\n\u0026lt;?php class PostsCombination { \/\/ 設定整合資訊  public function setCombinationInfo(\u0026amp;$Posts) { if (!($Posts instanceof Posts)) { return false; } \/\/ 文章網址  $url = url(\u0026#34;article\/{$Posts-\u0026gt;id}\u0026#34;) $Posts-\u0026gt;info-\u0026gt;url = $url; } } CombinationManager（複合資料整合管理）    項目 說明     用途 整理多個 Service 的資料成資訊   可以存取結構 Combination、Serivce、所有獨立結構   可以被存取結構 ServiceManager、Controller    當整合的資料需要經過不同的資料來源去判斷要產生什麼複合資訊，CombinationManager 協助整理不同來源的資料去做資料整合，目前會從 ServiceManager 去取得不同 Service 的資訊，所以將 CombinationManager 放在這一階層去進行呼叫\n\u0026lt;?php class PostsCombinationManager { protected $UserService; public function __construct( UserCombination $UserCombination, ProjectService $ProjectService ) { \/\/ 服務  $this-\u0026gt;UserCombination = $UserCombination; } public function setCombinationInfo(\u0026amp;$combination_data) { $Posts = array_get($combination_data, \u0026#39;Posts\u0026#39;); if ($Posts instanceof Posts) { \/\/ 設定文章關聯作者資訊  $this-\u0026gt;UserCombination-\u0026gt;setCombinationInfo($Posts-\u0026gt;User); \/\/ 是專題文章  if ($Posts-\u0026gt;type == PostsConstant::TYPE_PROJECT) { $Project = $this-\u0026gt;ProjectService-\u0026gt;findProjectByPostId($Posts-\u0026gt;id); $url = url(\u0026#34;project\/{$Project-\u0026gt;slug}\/{$Posts-\u0026gt;id}\u0026#34;) $Posts-\u0026gt;info-\u0026gt;url = $url; }; } } }  B.獨立結構 CacheManager (快取)    項目 說明     用途 管理資源快取鍵值及清除快取   可以存取結構 x   可以被存取結構 無限制    在 複雜 的資料庫查詢（Repository）或是商業邏輯（Service、ServiceManager），想要在一定時間內不要再重複的進行複雜的運算，可以透過快取將運算的結果快取起來\nPostsCacheManager 文章資源庫\nclass PostRepository { public function __construct( Post $Post, PostsCacheManager $PostsCacheManager ) { $this-\u0026gt;Post = $Post; $this-\u0026gt;PostsCacheManager = $PostsCacheManager; } public function find($post_id) { try { $cache_key = $this-\u0026gt;PostsCacheManager-\u0026gt;getPostIdCacheKey($post_id); $Posts = $this-\u0026gt;PostsCacheManager-\u0026gt;getCache($cache_key); if (!is_null($Posts)) { return $Posts; } \/\/ 撈取資料庫文章資料 $Posts = $this-\u0026gt;Post-\u0026gt;find($post_id); if (!is_null($Posts)) { \/\/ 有該資料，將資料存入快取 $this-\u0026gt;PostsCacheManager-\u0026gt;putCache($Posts, $cache_key); } return $Posts; } catch (Exception $exception) { throw $exception } } public function findLatestPost() { try { \/\/ 撈取資料庫文章資料 $Post = $this-\u0026gt;Post -\u0026gt;order(\u0026#39;created_at\u0026#39;, \u0026#39;desc\u0026#39;) -\u0026gt;first(); return $Post; } catch (Exception $exception) { throw $exception } } } PostsCacheManager 文章快取\nclass PostsCacheManager { protected $cache_key = [ \/\/ 文章快取 \u0026#39;post_id\u0026#39; =\u0026gt; \u0026#39;[PostById][post_id:{post_id}]\u0026#39;, \/\/ 已發布文章快取 \u0026#39;published_post_id\u0026#39; =\u0026gt; \u0026#39;[PublishedPostById][post_id:{post_id}]\u0026#39;, ]; \/** * 文章快取 *\/ public function getPostIdCacheKey($post_id) { $search = [ \u0026#39;{post_id}\u0026#39;, ]; $replace = [ $post_id, ]; $cache_key = str_replace($search, $replace, $this-\u0026gt;cache_key[\u0026#39;post_id\u0026#39;]); return $cache_key; } \/** * 已發布文章快取 *\/ public function getPublishedPostIdCacheKey($post_id) { $search = [ \u0026#39;{post_id}\u0026#39;, ]; $replace = [ $post_id, ]; $cache_key = str_replace($search, $replace, $this-\u0026gt;cache_key[\u0026#39;published_post_id\u0026#39;]); return $cache_key; } \/** * 文章快取 *\/ public function getPostIdCacheKey($post_id) { $search = [ \u0026#39;{post_id}\u0026#39;, ]; $replace = [ $post_id, ]; $cache_key = str_replace($search, $replace, $this-\u0026gt;cache_key[\u0026#39;post_id\u0026#39;]); return $cache_key; } \/** * 清除文章快取 *\/ public function forgetPostsCache($cache_data) { $Posts = array_get($cache_data, \u0026#39;Posts\u0026#39;); if (!is_null($Posts) AND ($Posts instanceof Posts)) { $cache_key = $this-\u0026gt;getPostIdCacheKey($post_id); $is_cache_forget = $Cache::forget($cache_key); $cache_key = $this-\u0026gt;getPublishedPostIdCacheKey($post_id); $is_cache_forget = $Cache::forget($cache_key); \/\/ .... 清除文章其他快取 } } }  Constant (常數)    項目 說明     用途 定義資料狀態名稱   可以存取結構 x   可以被存取結構 無限制    資料皆為靜態變數，可以供所有資料層級 (e.g. Controller、Service、Repository) 做存取\n\u0026lt;?php class PostConstant { const POST_TYPE_PUBLIC = \u0026#39;P\u0026#39;; const POST_TYPE_DELETE = \u0026#39;D\u0026#39;; } Support (支援)    項目 說明     用途 協助處理獨立邏輯資料處理   可以存取結構 x   可以被存取結構 無限制    方法皆為靜態變數，可以供所有資料層級 (e.g. Controller、Service、Repository) 做存取\n若有其他可供全域共用的方法皆寫在 Support 靜態方法供大家存取\n\u0026lt;?php class PostSupport { \/\/ 撈取所有文章類型  public static function getAllPostType() { $all_post_type = [ PostConstant::POST_TYPE_PUBLIC, PostConstant::POST_TYPE_DELETE, ]; return $all_post_type; } }  ExceptionCode (例外代碼)    項目 說明     用途 例外錯誤代碼定義   可以存取結構 x   可以被存取結構 x    資料皆為靜態變數，可以供所有資料層級 (e.g. Controller、Service、Repository) 做存取\n\u0026lt;?php class PostExceptionCode { const POST_ID_FORMAT_ERROR = 10000001; const POST_NOT_FOUND = 10000002; const POST_TAG_NOT_FOUND = 10000003; } View (視圖) 使用限制 View 的職責是負責顯示資料，所有的資料應由 Controller 準備好再傳給 View，所以不要在 View 內有複雜的程式判斷邏輯，在 View 裡面只有 if, for, foreach 跟 echo 列印 的程式，僅需要將資料呈現在對的 HTML 裡面，不要再對資料重複處理過。\n像是文章的網址可能會因為類型不同會有不同的網址，像是一般文章網址可能為 http:\/\/kejyun.com\/post\/1，而影音文章網址可能為 http:\/\/kejyun.com\/video\/2，兩者的資料皆為 Post 資料表的資料，在 View 中要顯示網址應為 echo $Post-\u0026gt;post_url; 將網址印出，post_url 則是在傳給 View 之前就經過邏輯判斷的資料，而不是在 View 中判斷不同文章類型（PostConstant::POST_TYPE_NORMAL, PostConstant::POST_TYPE_VIDEO）在 View 中顯示不同的網址資料。\n之後若文章網址邏輯需要修改，則需要到各個 View 中去修改，很容易漏改道造成系統程式出錯\n\u0026lt;a href=\u0026#34;{{ $Post-\u0026gt;info-\u0026gt;post_url }}\u0026#34;\u0026gt; {{ $Post-\u0026gt;Title }}\u0026lt;\/a\u0026gt; "
	}
</script>

  

  
    

















	
	
	
	  
		
		
		
		
		
	

	
	
	
	  
		
		
		
		
		
	

	
	
	



<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BreadcrumbList",
	"itemListElement":
		[{
			"@type": "ListItem",
				"position": 1,
				"item": {
					"@id": "https:\/\/laravel5-book.kejyun.com\/",
					"name": "Home"
				}
		},
		
			
		
			
				{
					"@type": "ListItem",
					"position":  2 ,
					"item": {
						"@id": "https:\/\/laravel5-book.kejyun.com\/structure",
						"name": "Structure"
					}
				}
				, 
			
		
			
				{
					"@type": "ListItem",
					"position":  3 ,
					"item": {
						"@id": "https:\/\/laravel5-book.kejyun.com\/structure\/combination-cache-manager-structure-principle",
						"name": "Combination cache manager structure principle"
					}
				}
				
			
		
	]
}
</script>

  

  

  

  

  

  

  

  
    


<script type="application/ld+json">
{
"@context": "http://www.schema.org",
"@type": "Person",
"@id": "https:\/\/laravel5-book.kejyun.com\/structure\/combination-cache-manager-structure-principle\/",
"name": "KJ",
"alternateName": "KJ",
"nationality": "Taiwan",

"affiliation": [
	{
		"@type": "Organization",
		"name": "KeJyun",
		"sameAs": [ "\n\n\n\n\n\"https://www.facebook.com/kejyunTaiwan\",\n\n\n\n\"https://github.com/kejyun\",\n\n\n\n\n\n\n\n\n\n\n\n\"https://laravel5-book.kejyun.com/\"\n"
		]
  	}
],

"gender": "male",
"Description": "IT Manager",
"disambiguatingDescription": "Hi I\u0027m Web Developer in Taiwan",

"worksFor": [
	{
		"@type": "Organization",
		"name": "KeJyun",
		"sameAs": [ "\n\n\n\n\n\"https://www.facebook.com/kejyunTaiwan\",\n\n\n\n\"https://github.com/kejyun\",\n\n\n\n\n\n\n\n\n\n\n\n\"https://laravel5-book.kejyun.com/\"\n"
		]
	}
],
"url": "https:\/\/laravel5-book.kejyun.com\/",
"image": "https:\/\/laravel5-book.kejyun.com\/company\/team\/KeJyun.png",

"sameAs": [ "\n\n\n\n\n\n\"https://ca.linkedin.com/in/kejyun/en\",\n\n\n\"https://github.com/kejyun\",\n\n\n\n\n\n\n\n\n\n\n\n\"\"\n"
	]
}
</script>

  

  

  

  

  

  

  

  

  
    

<script type="application/ld+json">
[
	{
		"@context": "http://schema.org",
		"@type": "Webpage",
		"specialty": "KeJyun Laravel 學習筆記",
		"mainContentOfPage": {
			"@context": "http://schema.org/",
			"@type": "WebPageElement",
			"cssSelector": ".body-content"
		},
		"primaryImageOfPage": "https:\/\/laravel5-book.kejyun.com\/images\/bg.jpg"
	},
	{
		"@context": "http://schema.org",
		"@type": "WebSite",
		"@id": "https:\/\/laravel5-book.kejyun.com\/",
		"additionalType": ["CreativeWork", "Person"],
		"url": "https:\/\/laravel5-book.kejyun.com\/",
		"name": "Laravel 學習筆記",
		"alternateName": "Laravel 學習筆記",
		"headline": "KeJyun Laravel 學習筆記",
		"image": "https:\/\/laravel5-book.kejyun.com\/images\/bg.jpg",
		"inLanguage": "zh-TW",
		"author": "KeJyun",
		"description": "KeJyun Laravel 學習筆記",
		"disambiguatingDescription": "KeJyun Laravel 學習筆記",
		"isFamilyFriendly": "http://schema.org/True",
		"contentRating": "NR",
		"sourceOrganization": "Laravel 學習筆記",
		"publisher": {
		  "@type": "Organization",
		  "name": "Laravel 學習筆記",
		  "logo": {
		    "@type": "ImageObject",
		    "url": "https:\/\/laravel5-book.kejyun.com\/images\/logo.jpeg",
		    "height": 60,
		    "width": 107
		  }
		},
		"mainEntity": {
			"@context": "http://schema.org",
			"@type": "localBusiness",
			"name": "Laravel 學習筆記",
			"image":"https:\/\/laravel5-book.kejyun.com\/images\/logo.jpeg",
			
			"priceRange":"$$",
			

			
			"address": {
				"@type": "PostalAddress",
				"streetAddress": "",
				"addressLocality": "",
				"addressRegion": "",
				"addressCountry": "",
				"postalCode": ""
			},
			"aggregateRating": {
				"@type": "AggregateRating",
				"ratingValue": "4.5",
				"reviewCount": "50"
			}
		},
		"potentialAction": {
			"@type": "SearchAction",
			"target": "https:\/\/laravel5-book.kejyun.com\/?search={search_term}",
			"query-input": "required name=search_term"
		},
		"keywords":[
			"laravel", "laravel 學習筆記", "KJ", "kejyun"
		],
		"hasPart": [
			{
				"@context": "http://schema.org/",
				"@type": "WPHeader",
				"@id": "#header",
				"headline": "KeJyun Laravel 學習筆記",
				"cssSelector": "#header",
				"potentialAction": [],
				"@graph":
				[]
			},
			{
				"@context": "http://schema.org/",
				"@type": "WPSidebar",
				"cssSelector": "#sidebar",
				"citation": [
				
				]
			},
			{
				"@context": "http://schema.org/",
				"@type": "WPFooter",
				"cssSelector": ".footer",
				"@id": "#footer",
				"copyrightHolder":"Laravel 學習筆記",
				"publisher": "Laravel 學習筆記",
				"copyrightYear":"2021"
			}
		]
	}
]
</script>

  

  
  </head>
  <body class="" data-url="/structure/combination-cache-manager-structure-principle/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" 
  href="https://laravel5-book.kejyun.com/"
>
  <img style="border-radius: 50%!important;height:auto;vertical-align: middle;" 
    alt="" 
    width="50" height="50" 
    class=""
    src="https://avatars1.githubusercontent.com/u/1586089?s=460&amp;u=184ce5bff7ceee1a681cabd2bf7b9d13e8edca67&amp;v=4"
  >
  <span style="vertical-align:middle;">
  Laravel 學習筆記
  </span>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1615475347"></script>
<script type="text/javascript" src="/js/auto-complete.js?1615475347"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/laravel5-book.kejyun.com\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1615475347"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/environment/" title="環境" class="dd-item 
        
        
        
        ">
      <a href="/environment/">
          <b>X. </b>環境
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/environment/dot-env-file/" title=".env 檔案" class="dd-item ">
        <a href="/environment/dot-env-file/">
        .env 檔案
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/environment/homestead/install-with-homestead/" title="Homestead" class="dd-item ">
        <a href="/environment/homestead/install-with-homestead/">
        Homestead
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/environment/install-composer/" title="Composer 安裝" class="dd-item ">
        <a href="/environment/install-composer/">
        Composer 安裝
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/environment/debug/" title="除錯" class="dd-item ">
        <a href="/environment/debug/">
        除錯
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/database/" title="Database" class="dd-item 
        
        
        
        ">
      <a href="/database/">
          <b>X. </b>Database
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/database/migration/" title="Migration (遷移)" class="dd-item ">
        <a href="/database/migration/">
        Migration (遷移)
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/database/model/" title="Eloquent Model (模型)" class="dd-item 
        
        
        
        ">
      <a href="/database/model/">
          Eloquent Model (模型)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-config/" title="Eloquent 設定" class="dd-item ">
        <a href="/database/model/eloquent-config/">
        Eloquent 設定
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-relationships/" title="Eloquent 關聯" class="dd-item ">
        <a href="/database/model/eloquent-relationships/">
        Eloquent 關聯
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-magic-function/" title="Eloquent 魔術函式" class="dd-item ">
        <a href="/database/model/eloquent-magic-function/">
        Eloquent 魔術函式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-apply/" title="使用 Eloquent" class="dd-item ">
        <a href="/database/model/eloquent-apply/">
        使用 Eloquent
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-lock/" title="鎖定資料 Lock" class="dd-item ">
        <a href="/database/model/eloquent-lock/">
        鎖定資料 Lock
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-tips/" title="Eloquent 小技巧" class="dd-item ">
        <a href="/database/model/eloquent-tips/">
        Eloquent 小技巧
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/model/eloquent-sub-query/" title="子查詢" class="dd-item ">
        <a href="/database/model/eloquent-sub-query/">
        子查詢
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/database/qa/" title="資料庫常見問題" class="dd-item 
        
        
        
        ">
      <a href="/database/qa/">
          資料庫常見問題
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/database/qa/cannot-get-querylog/" title="資料庫常見問題：無法取得查詢 Log" class="dd-item ">
        <a href="/database/qa/cannot-get-querylog/">
        資料庫常見問題：無法取得查詢 Log
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/qa/cannot-mass-insert/" title="使用大量資料的方式新增時無法新增" class="dd-item ">
        <a href="/database/qa/cannot-mass-insert/">
        使用大量資料的方式新增時無法新增
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/database/qa/cannot-mass-insert-with-extend-model/" title="使用中繼模型繼承 Eloquent 模型造成無法使用大量資料新增" class="dd-item ">
        <a href="/database/qa/cannot-mass-insert-with-extend-model/">
        使用中繼模型繼承 Eloquent 模型造成無法使用大量資料新增
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/database/postgresql/" title="PostgreSQL" class="dd-item 
        
        
        
        ">
      <a href="/database/postgresql/">
          PostgreSQL
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/database/postgresql/install-odbc-driver/" title="安裝 PostgreSQL ODBC driver" class="dd-item ">
        <a href="/database/postgresql/install-odbc-driver/">
        安裝 PostgreSQL ODBC driver
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/database/redis/" title="Redis" class="dd-item 
        
        
        
        ">
      <a href="/database/redis/">
          Redis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/database/redis/aws-cluster/aws-cluster/" title="AWS Redis 設定" class="dd-item ">
        <a href="/database/redis/aws-cluster/aws-cluster/">
        AWS Redis 設定
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/http/" title="Http" class="dd-item 
        
        
        
        ">
      <a href="/http/">
          <b>X. </b>Http
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/http/request/" title="Request 請求" class="dd-item 
        
        
        
        ">
      <a href="/http/request/">
          Request 請求
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/http/request/request/" title="HTTP 請求" class="dd-item ">
        <a href="/http/request/request/">
        HTTP 請求
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/http/request/request-cookie/" title="Cookie" class="dd-item ">
        <a href="/http/request/request-cookie/">
        Cookie
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/http/route/" title="Route 路由" class="dd-item 
        
        
        
        ">
      <a href="/http/route/">
          Route 路由
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/http/route/sub-domain-route/" title="子網域路由（Sub-Domain Route）" class="dd-item ">
        <a href="/http/route/sub-domain-route/">
        子網域路由（Sub-Domain Route）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/http/middleware/" title="中介層（Middleware）" class="dd-item 
        
        
        
        ">
      <a href="/http/middleware/">
          中介層（Middleware）
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/http/middleware/middleware-intro/" title="中介層介紹" class="dd-item ">
        <a href="/http/middleware/middleware-intro/">
        中介層介紹
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/http/middleware/etag-middleware/" title="ETag Middleware" class="dd-item ">
        <a href="/http/middleware/etag-middleware/">
        ETag Middleware
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/view/" title="視圖 (View)" class="dd-item 
        
        
        
        ">
      <a href="/view/">
          <b>X. </b>視圖 (View)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/view/view-intro/" title="視圖介紹" class="dd-item ">
        <a href="/view/view-intro/">
        視圖介紹
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/view/view-inject-class/" title="將 Class 綁定到視圖" class="dd-item ">
        <a href="/view/view-inject-class/">
        將 Class 綁定到視圖
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/services/" title="服務" class="dd-item 
        
        
        
        ">
      <a href="/services/">
          <b>X. </b>服務
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/services/auth/" title="認證（Auth）" class="dd-item 
        
        
        
        ">
      <a href="/services/auth/">
          認證（Auth）
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/auth/auth-login/" title="認證登入" class="dd-item ">
        <a href="/services/auth/auth-login/">
        認證登入
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/auth/auth-support-laravel-4/" title="認證支援 Laravel 4 Session" class="dd-item ">
        <a href="/services/auth/auth-support-laravel-4/">
        認證支援 Laravel 4 Session
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/mail/" title="郵件（Mail）" class="dd-item 
        
        
        
        ">
      <a href="/services/mail/">
          郵件（Mail）
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/mail/mail-gmail/" title="使用 Gmail 寄信" class="dd-item ">
        <a href="/services/mail/mail-gmail/">
        使用 Gmail 寄信
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/mail/mail-mailgun/" title="使用 Mailgun 寄信" class="dd-item ">
        <a href="/services/mail/mail-mailgun/">
        使用 Mailgun 寄信
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/queue/" title="隊列（Queue）" class="dd-item 
        
        
        
        ">
      <a href="/services/queue/">
          隊列（Queue）
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/queue/queue-intro/" title="隊列介紹" class="dd-item ">
        <a href="/services/queue/queue-intro/">
        隊列介紹
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/queue/queue-database/" title="Database Queue" class="dd-item ">
        <a href="/services/queue/queue-database/">
        Database Queue
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/queue/queue-async/" title="非同步資料庫隊列（Async Database Queue）" class="dd-item ">
        <a href="/services/queue/queue-async/">
        非同步資料庫隊列（Async Database Queue）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/queue/queue-supervisor/" title="Supervisor 啟動 queue" class="dd-item ">
        <a href="/services/queue/queue-supervisor/">
        Supervisor 啟動 queue
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/helpers/" title="輔助方法 (Helpers)" class="dd-item 
        
        
        
        ">
      <a href="/services/helpers/">
          輔助方法 (Helpers)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/helpers/custom-helpers/" title="自定義輔助方法" class="dd-item ">
        <a href="/services/helpers/custom-helpers/">
        自定義輔助方法
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/helpers/request-helpers/" title="請求資訊" class="dd-item ">
        <a href="/services/helpers/request-helpers/">
        請求資訊
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/unit-test/" title="單元測試" class="dd-item 
        
        
        
        ">
      <a href="/services/unit-test/">
          單元測試
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/unit-test/unit-test-post-csrf/" title="POST CSRF 錯誤" class="dd-item ">
        <a href="/services/unit-test/unit-test-post-csrf/">
        POST CSRF 錯誤
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/unit-test/unit-test-ajax-request-json-response/" title="Ajax Request &amp; JSON Response" class="dd-item ">
        <a href="/services/unit-test/unit-test-ajax-request-json-response/">
        Ajax Request &amp; JSON Response
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/unit-test/unit-test-assert/" title="Assert" class="dd-item ">
        <a href="/services/unit-test/unit-test-assert/">
        Assert
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/unit-test/unit-test-login-and-upload-file/" title="單元測試登入及上傳檔案" class="dd-item ">
        <a href="/services/unit-test/unit-test-login-and-upload-file/">
        單元測試登入及上傳檔案
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/unit-test/unit-test-change-root-url/" title="變更請求網址" class="dd-item ">
        <a href="/services/unit-test/unit-test-change-root-url/">
        變更請求網址
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/errors-logs/" title="錯誤與日誌 Log" class="dd-item 
        
        
        
        ">
      <a href="/services/errors-logs/">
          錯誤與日誌 Log
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/errors-show-exception-in-cli/" title="在單元測試顯示例外" class="dd-item ">
        <a href="/services/errors-logs/errors-show-exception-in-cli/">
        在單元測試顯示例外
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/errors-log-level/" title="日誌記錄層級" class="dd-item ">
        <a href="/services/errors-logs/errors-log-level/">
        日誌記錄層級
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/errors-log-macro/" title="日誌巨集" class="dd-item ">
        <a href="/services/errors-logs/errors-log-macro/">
        日誌巨集
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/errors-logs/packages/" title="日誌套件" class="dd-item 
        
        
        
        ">
      <a href="/services/errors-logs/packages/">
          日誌套件
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/packages/errors-log-packages-log-viewer/" title="Log Viewer" class="dd-item ">
        <a href="/services/errors-logs/packages/errors-log-packages-log-viewer/">
        Log Viewer
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/packages/errors-log-packages-slack-log/" title="Slack Log" class="dd-item ">
        <a href="/services/errors-logs/packages/errors-log-packages-slack-log/">
        Slack Log
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/errors-logs/service/" title="日誌服務" class="dd-item 
        
        
        
        ">
      <a href="/services/errors-logs/service/">
          日誌服務
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/service/errors-log-service-understand-io/" title="Understand.io" class="dd-item ">
        <a href="/services/errors-logs/service/errors-log-service-understand-io/">
        Understand.io
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/service/errors-log-service-sentry-io/" title="Sentry.io" class="dd-item ">
        <a href="/services/errors-logs/service/errors-log-service-sentry-io/">
        Sentry.io
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/service/errors-log-service-bugsnag/" title="Bugsnag" class="dd-item ">
        <a href="/services/errors-logs/service/errors-log-service-bugsnag/">
        Bugsnag
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/service/errors-log-service-rollbar/" title="Rollbar" class="dd-item ">
        <a href="/services/errors-logs/service/errors-log-service-rollbar/">
        Rollbar
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/errors-logs/service/errors-log-service-cloudwatch/" title="CloudWatch Log" class="dd-item ">
        <a href="/services/errors-logs/service/errors-log-service-cloudwatch/">
        CloudWatch Log
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/encryption/encryption-intro/" title="加密（encryption）" class="dd-item ">
        <a href="/services/encryption/encryption-intro/">
        加密（encryption）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/hashing/hashing-intro/" title="雜湊（Hashing）" class="dd-item ">
        <a href="/services/hashing/hashing-intro/">
        雜湊（Hashing）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/response/response-intro/" title="回應（Response）" class="dd-item ">
        <a href="/services/response/response-intro/">
        回應（Response）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/scheduling/scheduling-intro/" title="任務排程（Scheduling）" class="dd-item ">
        <a href="/services/scheduling/scheduling-intro/">
        任務排程（Scheduling）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/services/laravel-mix/" title="Laravel Mix" class="dd-item 
        
        
        
        ">
      <a href="/services/laravel-mix/">
          Laravel Mix
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/services/laravel-mix/laravel-mix-intro/" title="Laravel Mix 介紹" class="dd-item ">
        <a href="/services/laravel-mix/laravel-mix-intro/">
        Laravel Mix 介紹
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/laravel-mix/laravel-mix-live-reload/" title="LiveReload" class="dd-item ">
        <a href="/services/laravel-mix/laravel-mix-live-reload/">
        LiveReload
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/laravel-mix/laravel-mix-browser-sync/" title="BrowserSync" class="dd-item ">
        <a href="/services/laravel-mix/laravel-mix-browser-sync/">
        BrowserSync
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/services/compass/compass-intro/" title="Compass" class="dd-item ">
        <a href="/services/compass/compass-intro/">
        Compass
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/api/" title="API" class="dd-item 
        
        
        
        ">
      <a href="/api/">
          <b>X. </b>API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/api/api-intro/" title="API throttle middleware" class="dd-item ">
        <a href="/api/api-intro/">
        API throttle middleware
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/design-pattern/" title="設計模式" class="dd-item 
        
        
        
        ">
      <a href="/design-pattern/">
          <b>X. </b>設計模式
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/design-pattern/service-container/" title="服務容器（Service Container）" class="dd-item ">
        <a href="/design-pattern/service-container/">
        服務容器（Service Container）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/design-pattern/psr/" title="PSR" class="dd-item ">
        <a href="/design-pattern/psr/">
        PSR
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/design-pattern/model/" title="Model" class="dd-item ">
        <a href="/design-pattern/model/">
        Model
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/design-pattern/learning-resource/" title="學習資源" class="dd-item ">
        <a href="/design-pattern/learning-resource/">
        學習資源
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/structure/" title="程式架構規範" class="dd-item 
        parent
        
        
        ">
      <a href="/structure/">
          <b>X. </b>程式架構規範
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/structure/service-repository-structure-principle/" title="Service &amp; Repository 架構設計準則（2017 年版本）" class="dd-item ">
        <a href="/structure/service-repository-structure-principle/">
        Service &amp; Repository 架構設計準則（2017 年版本）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/structure/combination-cache-manager-structure-principle/" title="Combination &amp; Cache 架構設計準則（2019 年版本）" class="dd-item active">
        <a href="/structure/combination-cache-manager-structure-principle/">
        Combination &amp; Cache 架構設計準則（2019 年版本）
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/package/" title="套件" class="dd-item 
        
        
        
        ">
      <a href="/package/">
          <b>X. </b>套件
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/development/package-development/" title="套件開發" class="dd-item ">
        <a href="/package/development/package-development/">
        套件開發
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/image/" title="圖片" class="dd-item 
        
        
        
        ">
      <a href="/package/image/">
          圖片
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/package/image/intervention/" title="intervention" class="dd-item 
        
        
        
        ">
      <a href="/package/image/intervention/">
          intervention
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/image/intervention/package-image-intervention-process/" title="圖片處理" class="dd-item ">
        <a href="/package/image/intervention/package-image-intervention-process/">
        圖片處理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/package/image/intervention/package-image-intervention-other/" title="其他圖片處理" class="dd-item ">
        <a href="/package/image/intervention/package-image-intervention-other/">
        其他圖片處理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/package/image/package-image-screenshot-other/" title="screenshot 截圖" class="dd-item ">
        <a href="/package/image/package-image-screenshot-other/">
        screenshot 截圖
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/chart/" title="圖表" class="dd-item 
        
        
        
        ">
      <a href="/package/chart/">
          圖表
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/line-bot/" title="Line Bot" class="dd-item 
        
        
        
        ">
      <a href="/package/line-bot/">
          Line Bot
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/debug/" title="Debug 套件" class="dd-item 
        
        
        
        ">
      <a href="/package/debug/">
          Debug 套件
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/debug/package-debug-artisan-tail/" title="Artisan tail" class="dd-item ">
        <a href="/package/debug/package-debug-artisan-tail/">
        Artisan tail
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/tool/" title="工具" class="dd-item 
        
        
        
        ">
      <a href="/package/tool/">
          工具
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/tool/package-tool-carbon/" title="Carbon 時間套件" class="dd-item ">
        <a href="/package/tool/package-tool-carbon/">
        Carbon 時間套件
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/design-pattern/" title="設計模式" class="dd-item 
        
        
        
        ">
      <a href="/package/design-pattern/">
          設計模式
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/html/" title="HTML" class="dd-item 
        
        
        
        ">
      <a href="/package/html/">
          HTML
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/html/package-html-amp-readme/" title="AMP 文章" class="dd-item ">
        <a href="/package/html/package-html-amp-readme/">
        AMP 文章
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/text/" title="文字" class="dd-item 
        
        
        
        ">
      <a href="/package/text/">
          文字
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/api/" title="API" class="dd-item 
        
        
        
        ">
      <a href="/package/api/">
          API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/api/package-api-guzzlehttp/" title="GuzzleHttp" class="dd-item ">
        <a href="/package/api/package-api-guzzlehttp/">
        GuzzleHttp
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/view/" title="視圖" class="dd-item 
        
        
        
        ">
      <a href="/package/view/">
          視圖
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/mail/" title="郵件" class="dd-item 
        
        
        
        ">
      <a href="/package/mail/">
          郵件
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/mail/package-mail-mailchimp/" title="Mailchimp" class="dd-item ">
        <a href="/package/mail/package-mail-mailchimp/">
        Mailchimp
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/social/" title="社群" class="dd-item 
        
        
        
        ">
      <a href="/package/social/">
          社群
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/dashboard/" title="Dashboard" class="dd-item 
        
        
        
        ">
      <a href="/package/dashboard/">
          Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/platform/" title="平台" class="dd-item 
        
        
        
        ">
      <a href="/package/platform/">
          平台
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/auth/" title="認證" class="dd-item 
        
        
        
        ">
      <a href="/package/auth/">
          認證
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/package/auth/oauth/" title="OAuth2" class="dd-item 
        
        
        
        ">
      <a href="/package/auth/oauth/">
          OAuth2
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/package/auth/oauth/package-auth-oauth2-client-credentials/" title="Client Credentials" class="dd-item ">
        <a href="/package/auth/oauth/package-auth-oauth2-client-credentials/">
        Client Credentials
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/package/auth/oauth/package-auth-oauth2-password-grant/" title="Password Grant" class="dd-item ">
        <a href="/package/auth/oauth/package-auth-oauth2-password-grant/">
        Password Grant
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/package/auth/oauth/package-auth-oauth2-refresh-token/" title="Refresh Token" class="dd-item ">
        <a href="/package/auth/oauth/package-auth-oauth2-refresh-token/">
        Refresh Token
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/package/auth/oauth/package-auth-oauth2-password-grant-with-scope/" title="Password Grant with Scope" class="dd-item ">
        <a href="/package/auth/oauth/package-auth-oauth2-password-grant-with-scope/">
        Password Grant with Scope
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/package/auth/oauth/package-auth-oauth2-access-token-authentication/" title="驗證 Access Token" class="dd-item ">
        <a href="/package/auth/oauth/package-auth-oauth2-access-token-authentication/">
        驗證 Access Token
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/package/auth/jwt/" title="JWT" class="dd-item 
        
        
        
        ">
      <a href="/package/auth/jwt/">
          JWT
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/software/" title="軟體" class="dd-item 
        
        
        
        ">
      <a href="/software/">
          <b>X. </b>軟體
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/software/software-redis/" title="Redis" class="dd-item ">
        <a href="/software/software-redis/">
        Redis
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/hosting/" title="主機環境建置" class="dd-item 
        
        
        
        ">
      <a href="/hosting/">
          <b>X. </b>主機環境建置
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/hosting/nginx/hosting-install-nginx/" title="安裝 Nginx" class="dd-item ">
        <a href="/hosting/nginx/hosting-install-nginx/">
        安裝 Nginx
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hosting/php/hosting-install-php7/" title="安裝 php 7" class="dd-item ">
        <a href="/hosting/php/hosting-install-php7/">
        安裝 php 7
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hosting/composer/hosting-install-composer/" title="安裝 composer" class="dd-item ">
        <a href="/hosting/composer/hosting-install-composer/">
        安裝 composer
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hosting/mysql/hosting-install-mysql57/" title="安裝 MySQL 5.7" class="dd-item ">
        <a href="/hosting/mysql/hosting-install-mysql57/">
        安裝 MySQL 5.7
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hosting/memcached/hosting-install-memcached/" title="安裝 Memcached" class="dd-item ">
        <a href="/hosting/memcached/hosting-install-memcached/">
        安裝 Memcached
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hosting/redis/hosting-install-redis/" title="安裝 Redis" class="dd-item ">
        <a href="/hosting/redis/hosting-install-redis/">
        安裝 Redis
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hosting/lets-encrypt/hosting-install-lets-encrypt/" title="安裝 Memcached" class="dd-item ">
        <a href="/hosting/lets-encrypt/hosting-install-lets-encrypt/">
        安裝 Memcached
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/qa/" title="其他常見問題" class="dd-item 
        
        
        
        ">
      <a href="/qa/">
          <b>X. </b>其他常見問題
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/qa/qa-call-undefined-method-getcachedcompilepath/" title="Call to undefined method getCachedCompilePath()" class="dd-item ">
        <a href="/qa/qa-call-undefined-method-getcachedcompilepath/">
        Call to undefined method getCachedCompilePath()
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/qa/qa-change-app-directory-name-cause-view-can-not-readable/" title="變更專案目錄名稱導致 View 無法讀取" class="dd-item ">
        <a href="/qa/qa-change-app-directory-name-cause-view-can-not-readable/">
        變更專案目錄名稱導致 View 無法讀取
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/qa/qa-segmentation-fault-11-when-seeding/" title="Segmentation fault: 11 when seeding" class="dd-item ">
        <a href="/qa/qa-segmentation-fault-11-when-seeding/">
        Segmentation fault: 11 when seeding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/editor/" title="編輯器" class="dd-item 
        
        
        
        ">
      <a href="/editor/">
          <b>X. </b>編輯器
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/editor/tips/" title="小技巧" class="dd-item 
        
        
        
        ">
      <a href="/editor/tips/">
          小技巧
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/editor/tips/editor-tips-recognize-facade-class/" title="讓編輯器識別 Facade 類別" class="dd-item ">
        <a href="/editor/tips/editor-tips-recognize-facade-class/">
        讓編輯器識別 Facade 類別
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/resource/" title="學習資源" class="dd-item 
        
        
        
        ">
      <a href="/resource/">
          <b>X. </b>學習資源
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-official/" title="官方" class="dd-item ">
        <a href="/resource/resource-official/">
        官方
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-community/" title="社群" class="dd-item ">
        <a href="/resource/resource-community/">
        社群
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-conference/" title="會議議程" class="dd-item ">
        <a href="/resource/resource-conference/">
        會議議程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-jobs/" title="工作" class="dd-item ">
        <a href="/resource/resource-jobs/">
        工作
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-document/" title="文件" class="dd-item ">
        <a href="/resource/resource-document/">
        文件
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-article/" title="文章" class="dd-item ">
        <a href="/resource/resource-article/">
        文章
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-packages/" title="套件" class="dd-item ">
        <a href="/resource/resource-packages/">
        套件
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-learning-video/" title="教學影片" class="dd-item ">
        <a href="/resource/resource-learning-video/">
        教學影片
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-laravel-service/" title="服務工具" class="dd-item ">
        <a href="/resource/resource-laravel-service/">
        服務工具
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-learning-website/" title="教學網站" class="dd-item ">
        <a href="/resource/resource-learning-website/">
        教學網站
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-editor-tool/" title="編輯開發" class="dd-item ">
        <a href="/resource/resource-editor-tool/">
        編輯開發
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-hosting/" title="主機" class="dd-item ">
        <a href="/resource/resource-hosting/">
        主機
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/resource/resource-laravel-case/" title="成功案例" class="dd-item ">
        <a href="/resource/resource-laravel-case/">
        成功案例
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/kejyun"><i class='fab fa-github'></i> Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://laravel5-book.kejyun.com/tags"><i class='fas fa-tags'></i> Tags</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>首頁</a> > <a href='/structure/'>程式架構規範</a> > Combination & Cache 架構設計準則（2019 年版本）
          
        
          
        
          
        
                 
                  </span>
                </div>
                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
          <div id="chapter">
        
        <div id="body-inner">
          

        




<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<h1 id="combination--cache-架構設計準則2019-年版本">Combination &amp; Cache 架構設計準則（2019 年版本）</h1>
<p>傳統的 MVC（Model, View, Controller） 框架，當 Controller 收到請求之後，我們會在 Controller 內直接透過 Model 去撈取資料庫的資料，並在 Controller 做資料驗證、資料整合、快取、商業邏輯判斷&hellip;等等的工作。</p>
<p>當系統越來越大，會發現很多類似的商業邏輯的程式都散在各地，沒有辦法重複再利用，當程式需要異動或修改的時候，就要去搜尋所有程式碼，把許多相同商業邏輯的程式碼去做異動，但需要修改的地方若太多，往往會東漏西漏，導致系統出現錯誤，並造成往後開發的時間成本增加。</p>
<p>所以我們會想要做到 <code>減少重複的程式碼</code>、<code>提高維護開發的效率</code>，所以將程式碼依照<code>分類</code>及<code>分層</code>抽出獨立控管，讓不同類型的程式專心處理自己相關的商業邏輯，讓開發維護更容易。</p>
<p>隨著程式架構的演進會發展出更多不同的架構，所以這個設計架構準則也是會隨著時間做演進的。</p>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="資料處理邏輯分層">資料處理邏輯分層</h2>
<h3 id="架構圖">架構圖</h3>
<p><img src="../images/combination-cache-structure.png" alt="架構圖"></p>
<h3 id="架構說明">架構說明</h3>
<h4 id="a-資料控制結構">A. 資料控制結構</h4>
<pre><code>* Controller (控制器：控制資料流程)
    * ServiceManager (服務整合管理：組合管理不同 Service 的商業邏輯)
        * Service (服務：處理商業邏輯)
            * Repository (資源庫：資料表資料撈取邏輯)
                * Model (資料庫模型：資料表設定)
                    * Presenter (資料呈現：資料表資料格式呈現轉換)
            * Combination（資料整合：整理 Repository 資料成資訊）
    * CombinationManager（複合資料整合管理：整理多個 Service 的資料成資訊）
* Checker (檢查器：根據 Controller 所需商業邏輯，驗證不同資料表欄位資料)
    * Validator (驗證器：資料表欄位資料驗證)
</code></pre><table>
<thead>
<tr>
<th>結構名稱</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Controller (控制器)</td>
<td>控制資料流程，控制要使用哪些 Service 或 ServiceManager 的商業邏輯，去組合出使用者請求需要的資料，並做資料的資料交易控制 (transaction) ，並使用 Checker 去檢查任何使用者傳進來的資料，確保資料的正確性</td>
</tr>
<tr>
<td>ServiceManager (服務整合管理)</td>
<td>協助 Controller 組合不同 Service 的資料成商業邏輯</td>
</tr>
<tr>
<td>Service (服務)</td>
<td>處理商業邏輯，組合不同的 Repository 資料成商業邏輯，提供 Controller 或 ServiceManager 存取</td>
</tr>
<tr>
<td>Repository (資源庫)</td>
<td>資料表資料撈取邏輯，撈取屬於自己 Model 不同條件下的資料，提供 Service 存取</td>
</tr>
<tr>
<td>Model (資料庫模型)</td>
<td>資料庫模型，資料表存取相關設定</td>
</tr>
<tr>
<td>Presenter (資料呈現)</td>
<td>資料呈現，協助 Model 做資料呈現轉換</td>
</tr>
<tr>
<td>Checker (檢查器)</td>
<td>協助 Controller 做資料驗證，在資料進入到程式邏輯前，都需要經過 Checker 將資料格式做驗證</td>
</tr>
<tr>
<td>Validator (驗證器)</td>
<td>協助 Checker 做資料驗證，Validator 只能驗證單一 Model 資料</td>
</tr>
<tr>
<td>CombinationManager (複合資料整合管理)</td>
<td>協助整理不同 Service 的複合式資料，若有資料的邏輯判斷需要不同的資料來源，則由 CombinationManager 負責整合處理</td>
</tr>
<tr>
<td>Combination （資料整合）</td>
<td>協助整理 Repository 資料成資訊</td>
</tr>
</tbody>
</table>
<h4 id="b獨立結構">B.獨立結構</h4>
<pre><code>* CacheManager (快取：管理資源快取鍵值及清除快取)
* Constant (常數：定義資料狀態名稱)
* Support (支援：協助處理獨立邏輯資料處理)
* ExceptionCode (例外代碼：例外錯誤代碼定義)
</code></pre><table>
<thead>
<tr>
<th>結構名稱</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>CacheManager (快取)</td>
<td>協助專案資料做快取資料的控制，可以在任何程式邏輯複雜的地方做快取存取控制，並統一清除快取</td>
</tr>
<tr>
<td>Constant (常數)</td>
<td>定義並命名所有資料狀態，確保資料值做異動時，不會影響程式邏輯</td>
</tr>
<tr>
<td>Support (支援)</td>
<td>協助處理獨立程式邏輯，邏輯沒有被其他任何的函式綁定，可以獨立完成</td>
</tr>
<tr>
<td>ExceptionCode (例外代碼)</td>
<td>定義例外代碼，可以統一管控當例外發生錯誤時，回傳的錯誤代碼</td>
</tr>
</tbody>
</table>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="架構存取限制">架構存取限制</h3>
<ol>
<li>不能跨 2 階層以上存取
<ul>
<li>Controller 不能存取 Repository</li>
<li>Controller 不能存取 Validator</li>
<li>Service 不能存取 Model</li>
</ul>
</li>
<li>低階層的不能存取高階層的資料
<ul>
<li>Model 不能存取 Repository</li>
<li>Repository 不能存取 Service</li>
<li>Validator 不能存取 Checker</li>
</ul>
</li>
<li>同一個資料類型，不能互相呼叫
<ul>
<li>避免同一類型類別呼叫，造成 new 物件的時候有無窮迴圈
<ul>
<li>PostService 存取 UserService，UserService 存取 PostsService 造成無窮迴圈</li>
</ul>
</li>
<li>ServiceManager 不能呼叫 ServiceManager</li>
<li>Service 不能呼叫 Service</li>
<li>Checker 不能呼叫 Checker</li>
<li>Validator 不能呼叫 Validator</li>
<li>Repository 不能呼叫 Repository</li>
<li>CacheManager 不能呼叫 CacheManager</li>
</ul>
</li>
<li>獨立結構可以在任何一階層去呼叫</li>
</ol>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="架構設計邏輯範例說明">架構設計邏輯範例說明</h2>
<h3 id="a-資料控制結構-1">A. 資料控制結構</h3>
<h4 id="controller-控制器">Controller (控制器)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>控制資料流程</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>Checker</code>、<code>ServiceManager</code>、<code>Service</code>、<code>DB transaction</code>，<code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td>無</td>
</tr>
</tbody>
</table>
<p>處理 HTTP 請求的入口，依照需求呼叫 ServiceManager 或 Service 去做資料的存取，大部分情況呼叫 Service 去組合需要的資料就好，若相同的組合邏輯在不同的 Controller 都有用到，那就使用 ServiceManager 去組合不同的 Service</p>
<p>要確保所有 Service 商業邏輯都正確跑完才允許對資料做異動，並避免 Transaction 在 Controller 及 Service 被重複呼叫，導致無法正確鎖定資料狀態，所以使用 Controller 當作資料交易（Transaction）的控制點</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostController</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Controller</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(
        <span style="color:#a6e22e">PostServiceManager</span> $PostServiceManager,
        <span style="color:#a6e22e">PostService</span> $PostService,
        <span style="color:#a6e22e">CommentService</span> $CommentService,
        <span style="color:#a6e22e">PostChecker</span> $PostChecker
    )
    {
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostServiceManager</span> <span style="color:#f92672">=</span> $PostServiceManager;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostService</span> <span style="color:#f92672">=</span> $PostService;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">CommentService</span> <span style="color:#f92672">=</span> $CommentService;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostChecker</span> <span style="color:#f92672">=</span> $PostChecker;
    }

    <span style="color:#75715e">// 顯示文章
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">show</span>($post_id) {
        <span style="color:#66d9ef">try</span> {
            <span style="color:#75715e">// 驗證資料
</span><span style="color:#75715e"></span>            $input <span style="color:#f92672">=</span> [
                <span style="color:#e6db74">&#39;post_id&#39;</span> <span style="color:#f92672">=&gt;</span> $post_id
            ];
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostChecker</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">checkShow</span>($input);

            <span style="color:#75715e">// 撈取文章
</span><span style="color:#75715e"></span>            $Post <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostServiceManager</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">findPost</span>($post_id);

            <span style="color:#75715e">// 撈取文章留言
</span><span style="color:#75715e"></span>            $Comment <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">CommentService</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getCommentByPostId</span>(<span style="color:#a6e22e">post_id</span>);
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $exception) {
            <span style="color:#66d9ef">throw</span> $exception
        }
    }

    <span style="color:#75715e">// 更新文章
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">update</span>($post_id) {
        <span style="color:#66d9ef">try</span> {
            <span style="color:#75715e">// 驗證資料
</span><span style="color:#75715e"></span>            $input <span style="color:#f92672">=</span> <span style="color:#a6e22e">request</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">all</span>();
            $input[<span style="color:#e6db74">&#39;post_id&#39;</span>] <span style="color:#f92672">=</span> $post_id;
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostChecker</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">checkUpdate</span>($input);

            <span style="color:#75715e">// 交易開始
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">DB</span><span style="color:#f92672">::</span><span style="color:#a6e22e">beginTransaction</span>();

            <span style="color:#75715e">// 更新文章
</span><span style="color:#75715e"></span>            $Post <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostService</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">update</span>($post_id, $input);

            <span style="color:#75715e">// 交易結束
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">DB</span><span style="color:#f92672">::</span><span style="color:#a6e22e">commit</span>();
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $exception) {
            <span style="color:#75715e">// 交易失敗
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">DB</span><span style="color:#f92672">::</span><span style="color:#a6e22e">rollBack</span>();
            <span style="color:#66d9ef">throw</span> $exception
        }
    }
}
</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="servicemanager-服務整合管理">ServiceManager (服務整合管理)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>組合管理不同 Service 的商業邏輯</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>Service</code>、<code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Controller</code></td>
</tr>
</tbody>
</table>
<p>使用不同 Service 撈取資料，將不同資料組合成商業邏輯，供 Controller 做存取</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostServiceManager</span> {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(
        <span style="color:#a6e22e">PostService</span> $PostService,
        <span style="color:#a6e22e">UserService</span> $UserService
    )
    {
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostService</span> <span style="color:#f92672">=</span> $PostService;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">UserService</span> <span style="color:#f92672">=</span> $UserService;
    }

    <span style="color:#75715e">// 撈取文章資料
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">findPost</span>($post_id){
        <span style="color:#66d9ef">try</span> {
            <span style="color:#75715e">// 撈取文章
</span><span style="color:#75715e"></span>            $Post <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostService</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">findPost</span>($post_id);
            <span style="color:#75715e">// 撈取文章作者資料
</span><span style="color:#75715e"></span>            $user_id <span style="color:#f92672">=</span> $Post<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">user_id</span>;
            $Post<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">UserService</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">findUser</span>($user_id);

            <span style="color:#66d9ef">return</span> $Post;
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $exception) {
            <span style="color:#66d9ef">throw</span> $exception
        }
    }
}
</code></pre></div><h4 id="service-服務">Service (服務)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>處理商業邏輯</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>Repository</code>、<code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Controller</code>、<code>ServiceManager</code></td>
</tr>
</tbody>
</table>
<p>使用不同的 Repository 撈取資料，將不同資料組合成商業邏輯</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostService</span> {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(
        <span style="color:#a6e22e">PostRepository</span> $PostRepository,
        <span style="color:#a6e22e">PostTagRepository</span> $PostTagRepository
    )
    {
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostRepository</span> <span style="color:#f92672">=</span> $PostRepository;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostTagRepository</span> <span style="color:#f92672">=</span> $PostTagRepository;
    }

    <span style="color:#75715e">// 撈取文章
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">findPost</span>($post_id) {
        <span style="color:#66d9ef">try</span> {
            <span style="color:#75715e">// 撈取文章
</span><span style="color:#75715e"></span>            $Post <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostRepository</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">find</span>($post_id);
            <span style="color:#75715e">// 撈取文章標籤
</span><span style="color:#75715e"></span>            $Tag <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostTagRepository</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getByPostId</span>($post_id);

            <span style="color:#66d9ef">return</span> [$Post, $Tag];
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $exception) {
            <span style="color:#66d9ef">throw</span> $exception
        }
    }
}
</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="repository-資源庫">Repository (資源庫)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>資料表資料撈取邏輯</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>Model</code>、<code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Service</code></td>
</tr>
</tbody>
</table>
<p>撈取特定 Model 資料，像 <code>PostRepository</code> 可以存取 <code>Post</code> Model (模型) 的 <em>基本資料</em>，並使用不同條件撈取 Model 的資料，供 Service 做存取</p>
<p>也可以使用 <code>PostRecommendRepository</code> 存取 <code>Post</code> Model (模型) 的 <em>推薦資料</em></p>
<p>同一個 Model (模型) 可以用不同的 Repository 去呼叫，但同一 Repository 只能有一個 Model (模型)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostRepository</span> {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(
        <span style="color:#a6e22e">Post</span> $Post
    )
    {
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Post</span> <span style="color:#f92672">=</span> $Post;
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">find</span>($post_id) {
        <span style="color:#66d9ef">try</span> {

            <span style="color:#75715e">// 撈取資料庫文章資料
</span><span style="color:#75715e"></span>            $Post <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Post</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">find</span>($post_id);

            <span style="color:#66d9ef">return</span> $Post;
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $exception) {
            <span style="color:#66d9ef">throw</span> $exception
        }
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">findLatestPost</span>() {
        <span style="color:#66d9ef">try</span> {
            <span style="color:#75715e">// 撈取資料庫文章資料
</span><span style="color:#75715e"></span>            $Post <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Post</span>
                <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">order</span>(<span style="color:#e6db74">&#39;created_at&#39;</span>, <span style="color:#e6db74">&#39;desc&#39;</span>)
                <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">first</span>();

            <span style="color:#66d9ef">return</span> $Post;
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> $exception) {
            <span style="color:#66d9ef">throw</span> $exception
        }
    }
}
</code></pre></div><h4 id="model-資料庫模型">Model (資料庫模型)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>資料表設定</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Repository</code></td>
</tr>
</tbody>
</table>
<p>Eloquent 存取資料表相關設定，使用 Eloquent 直接存取資料表資料</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Post</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Model</span>
{
    <span style="color:#66d9ef">protected</span> $table <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;post&#39;</span>;

    <span style="color:#66d9ef">protected</span> $fillable <span style="color:#f92672">=</span> [];

    <span style="color:#66d9ef">protected</span> $primaryKey <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;id&#39;</span>;

    <span style="color:#66d9ef">protected</span> $dates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;created_at&#39;</span>, <span style="color:#e6db74">&#39;updated_at&#39;</span>];

    <span style="color:#66d9ef">protected</span> $presenter <span style="color:#f92672">=</span> <span style="color:#a6e22e">PostPresenter</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>;
}
</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="presenter-資料呈現">Presenter (資料呈現)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>資料表資料格式呈現轉換</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Model</code></td>
</tr>
</tbody>
</table>
<p>提供 Model 的資料用其他方式呈現</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostPresenter</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Presenter</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">created_at_human_time</span>()
    {
        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">created_at</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">diffForHumans</span>();
    }
}
</code></pre></div><h4 id="checker-檢查器">Checker (檢查器)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>根據 Controller 所需商業邏輯，驗證不同資料表欄位資料</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>Validator</code>、<code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Controller</code></td>
</tr>
</tbody>
</table>
<p>協助 Controller 驗證不同資料表資料的正確性，若驗證錯誤則丟處例外，Controller 根據例外代碼去做處理</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostValidator</span> {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">checkFindPost</span>($input){
        <span style="color:#75715e">// 驗證文章資料
</span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostValidator</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">validatePostId</span>($input);
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PostValidator</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">validatePostContent</span>($input);

        <span style="color:#75715e">// 驗證會員資料
</span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">MemberValidator</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">validateMemberId</span>($input);
    }
}
</code></pre></div><h4 id="validator-驗證器">Validator (驗證器)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>資料表欄位資料驗證</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Checker</code></td>
</tr>
</tbody>
</table>
<p>協助 Checker 驗證資料的正確性，若驗證錯誤則丟處例外，Checker 根據例外代碼去做處理</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostValidator</span> {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">validatePostId</span>($input){
        <span style="color:#75715e">// 設定驗證規則
</span><span style="color:#75715e"></span>        $rules <span style="color:#f92672">=</span> [
            <span style="color:#e6db74">&#39;post_id&#39;</span> <span style="color:#f92672">=&gt;</span> [
                <span style="color:#e6db74">&#39;required&#39;</span>,
                <span style="color:#e6db74">&#39;max:20&#39;</span>,
            ],
        ];

        <span style="color:#75715e">// 開始驗證
</span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">validator</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Validator</span><span style="color:#f92672">::</span><span style="color:#a6e22e">make</span>($input, $rules);

        <span style="color:#66d9ef">if</span> ($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">validator</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fails</span>()) {
            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Exception</span>(
                <span style="color:#e6db74">&#39;文章編號格式錯誤&#39;</span>,
                <span style="color:#a6e22e">PostExceptionCode</span><span style="color:#f92672">::</span><span style="color:#a6e22e">POST_ID_FORMAT_ERROR</span>
            );
        }
    }
}
</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="combination資料整合">Combination（資料整合）</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>整理 Repository 資料成資訊</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>Serivce</code>、<code>CombinationManager</code></td>
</tr>
</tbody>
</table>
<p>當 Service 從 Repository 取得資料後，協助整理判斷 Repository 資料的屬性狀態，像是可以從 <em>文章編號</em> 取得 <em>文章網址</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostsCombination</span> {
    <span style="color:#75715e">// 設定整合資訊
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setCombinationInfo</span>(<span style="color:#f92672">&amp;</span>$Posts)
    {
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>($Posts <span style="color:#a6e22e">instanceof</span> <span style="color:#a6e22e">Posts</span>)) {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
        }

        <span style="color:#75715e">// 文章網址
</span><span style="color:#75715e"></span>        $url <span style="color:#f92672">=</span> <span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#34;article/</span><span style="color:#e6db74">{</span>$Posts-&gt;id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)

        $Posts<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">info</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> $url;
    }
}
</code></pre></div><h4 id="combinationmanager複合資料整合管理">CombinationManager（複合資料整合管理）</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>整理多個 Service 的資料成資訊</td>
</tr>
<tr>
<td>可以存取結構</td>
<td><code>Combination</code>、<code>Serivce</code>、<code>所有獨立結構</code></td>
</tr>
<tr>
<td>可以被存取結構</td>
<td><code>ServiceManager</code>、<code>Controller</code></td>
</tr>
</tbody>
</table>
<p>當整合的資料需要經過不同的資料來源去判斷要產生什麼複合資訊，CombinationManager 協助整理不同來源的資料去做資料整合，目前會從 ServiceManager 去取得不同 Service 的資訊，所以將 CombinationManager 放在這一階層去進行呼叫</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostsCombinationManager</span> {
    <span style="color:#66d9ef">protected</span> $UserService;
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(
        <span style="color:#a6e22e">UserCombination</span> $UserCombination,
        <span style="color:#a6e22e">ProjectService</span> $ProjectService
    ) {
        <span style="color:#75715e">// 服務
</span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">UserCombination</span> <span style="color:#f92672">=</span> $UserCombination;
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setCombinationInfo</span>(<span style="color:#f92672">&amp;</span>$combination_data)
    {
        $Posts <span style="color:#f92672">=</span> <span style="color:#a6e22e">array_get</span>($combination_data, <span style="color:#e6db74">&#39;Posts&#39;</span>);
        <span style="color:#66d9ef">if</span> ($Posts <span style="color:#a6e22e">instanceof</span> <span style="color:#a6e22e">Posts</span>) {
            <span style="color:#75715e">// 設定文章關聯作者資訊
</span><span style="color:#75715e"></span>            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">UserCombination</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setCombinationInfo</span>($Posts<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">User</span>);

            <span style="color:#75715e">// 是專題文章
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> ($Posts<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">type</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">PostsConstant</span><span style="color:#f92672">::</span><span style="color:#a6e22e">TYPE_PROJECT</span>) {
                $Project <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ProjectService</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">findProjectByPostId</span>($Posts<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">id</span>);
                $url <span style="color:#f92672">=</span> <span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#34;project/</span><span style="color:#e6db74">{</span>$Project-&gt;slug<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>$Posts-&gt;id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
                $Posts<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">info</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> $url;
            };
        }
    }
}

</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="b獨立結構-1">B.獨立結構</h3>
<h4 id="cachemanager-快取">CacheManager (快取)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>管理資源快取鍵值及清除快取</td>
</tr>
<tr>
<td>可以存取結構</td>
<td>x</td>
</tr>
<tr>
<td>可以被存取結構</td>
<td>無限制</td>
</tr>
</tbody>
</table>
<p>在 <em>複雜</em> 的資料庫查詢（Repository）或是商業邏輯（Service、ServiceManager），想要在一定時間內不要再重複的進行複雜的運算，可以透過快取將運算的結果快取起來</p>
<p><em>PostsCacheManager 文章資源庫</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">class PostRepository {
    public function __construct(
        Post $Post,
        PostsCacheManager $PostsCacheManager
    )
    {
        $this-&gt;Post = $Post;
        $this-&gt;PostsCacheManager = $PostsCacheManager;
    }

    public function find($post_id) {
        try {
            $cache_key = $this-&gt;PostsCacheManager-&gt;getPostIdCacheKey($post_id);
            $Posts = $this-&gt;PostsCacheManager-&gt;getCache($cache_key);
            if (!is_null($Posts)) {
                return $Posts;
            }

            // 撈取資料庫文章資料
            $Posts = $this-&gt;Post-&gt;find($post_id);

            if (!is_null($Posts)) {
                // 有該資料，將資料存入快取
                $this-&gt;PostsCacheManager-&gt;putCache($Posts, $cache_key);
            }

            return $Posts;
        } catch (Exception $exception) {
            throw $exception
        }
    }

    public function findLatestPost() {
        try {
            // 撈取資料庫文章資料
            $Post = $this-&gt;Post
                -&gt;order(&#39;created_at&#39;, &#39;desc&#39;)
                -&gt;first();

            return $Post;
        } catch (Exception $exception) {
            throw $exception
        }
    }
}
</code></pre></div><p><em>PostsCacheManager 文章快取</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">class PostsCacheManager {
    protected $cache_key = [
        // 文章快取
        &#39;post_id&#39; =&gt; &#39;[PostById][post_id:{post_id}]&#39;,
        // 已發布文章快取
        &#39;published_post_id&#39; =&gt; &#39;[PublishedPostById][post_id:{post_id}]&#39;,
    ];

    /**
     * 文章快取
     */
    public function getPostIdCacheKey($post_id)
    {
        $search = [
            &#39;{post_id}&#39;,
        ];
        $replace = [
            $post_id,
        ];
        $cache_key = str_replace($search, $replace, $this-&gt;cache_key[&#39;post_id&#39;]);

        return $cache_key;
    }

    /**
     * 已發布文章快取
     */
    public function getPublishedPostIdCacheKey($post_id)
    {
        $search = [
            &#39;{post_id}&#39;,
        ];
        $replace = [
            $post_id,
        ];
        $cache_key = str_replace($search, $replace, $this-&gt;cache_key[&#39;published_post_id&#39;]);

        return $cache_key;
    }

    /**
     * 文章快取
     */
    public function getPostIdCacheKey($post_id)
    {
        $search = [
            &#39;{post_id}&#39;,
        ];
        $replace = [
            $post_id,
        ];
        $cache_key = str_replace($search, $replace, $this-&gt;cache_key[&#39;post_id&#39;]);

        return $cache_key;
    }


    /**
     * 清除文章快取
     */
    public function forgetPostsCache($cache_data)
    {
        $Posts = array_get($cache_data, &#39;Posts&#39;);


        if (!is_null($Posts) AND ($Posts instanceof Posts)) {
            $cache_key = $this-&gt;getPostIdCacheKey($post_id);
            $is_cache_forget = $Cache::forget($cache_key);

            $cache_key = $this-&gt;getPublishedPostIdCacheKey($post_id);
            $is_cache_forget = $Cache::forget($cache_key);

            // .... 清除文章其他快取
        }
    }
}
</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="constant-常數">Constant (常數)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>定義資料狀態名稱</td>
</tr>
<tr>
<td>可以存取結構</td>
<td>x</td>
</tr>
<tr>
<td>可以被存取結構</td>
<td>無限制</td>
</tr>
</tbody>
</table>
<p>資料皆為靜態變數，可以供所有資料層級 (e.g. Controller、Service、Repository) 做存取</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostConstant</span> {
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">POST_TYPE_PUBLIC</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;P&#39;</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">POST_TYPE_DELETE</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;D&#39;</span>;
}
</code></pre></div><h4 id="support-支援">Support (支援)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>協助處理獨立邏輯資料處理</td>
</tr>
<tr>
<td>可以存取結構</td>
<td>x</td>
</tr>
<tr>
<td>可以被存取結構</td>
<td>無限制</td>
</tr>
</tbody>
</table>
<p>方法皆為靜態變數，可以供所有資料層級 (e.g. Controller、Service、Repository) 做存取</p>
<p>若有其他可供全域共用的方法皆寫在 Support 靜態方法供大家存取</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostSupport</span> {
    <span style="color:#75715e">// 撈取所有文章類型
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getAllPostType</span>() {
        $all_post_type <span style="color:#f92672">=</span> [
            <span style="color:#a6e22e">PostConstant</span><span style="color:#f92672">::</span><span style="color:#a6e22e">POST_TYPE_PUBLIC</span>,
            <span style="color:#a6e22e">PostConstant</span><span style="color:#f92672">::</span><span style="color:#a6e22e">POST_TYPE_DELETE</span>,
        ];
        <span style="color:#66d9ef">return</span> $all_post_type;
    }
}
</code></pre></div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="exceptioncode-例外代碼">ExceptionCode (例外代碼)</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>用途</td>
<td>例外錯誤代碼定義</td>
</tr>
<tr>
<td>可以存取結構</td>
<td>x</td>
</tr>
<tr>
<td>可以被存取結構</td>
<td>x</td>
</tr>
</tbody>
</table>
<p>資料皆為靜態變數，可以供所有資料層級 (e.g. Controller、Service、Repository) 做存取</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostExceptionCode</span> {
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">POST_ID_FORMAT_ERROR</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000001</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">POST_NOT_FOUND</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000002</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">POST_TAG_NOT_FOUND</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000003</span>;
}
</code></pre></div><h2 id="view-視圖-使用限制">View (視圖) 使用限制</h2>
<p><code>View</code> 的職責是負責顯示資料，所有的資料應由 <code>Controller</code> 準備好再傳給 <code>View</code>，所以<code>不要</code>在 <code>View</code> 內有複雜的程式判斷邏輯，在 <code>View</code> 裡面只有 <code>if</code>, <code>for</code>, <code>foreach</code> 跟 <code>echo 列印</code> 的程式，僅需要將資料呈現在對的 HTML 裡面，不要再對資料重複處理過。</p>
<p>像是文章的網址可能會因為類型不同會有不同的網址，像是一般文章網址可能為 <code>http://kejyun.com/post/1</code>，而影音文章網址可能為 <code>http://kejyun.com/video/2</code>，兩者的資料皆為 Post 資料表的資料，在 <code>View</code> 中要顯示網址應為 <code>echo $Post-&gt;post_url;</code> 將網址印出，<code>post_url</code> 則是在傳給 <code>View</code> 之前就經過邏輯判斷的資料，而不是在 <code>View</code> 中判斷不同文章類型（<code>PostConstant::POST_TYPE_NORMAL</code>, <code>PostConstant::POST_TYPE_VIDEO</code>）在 View 中顯示不同的網址資料。</p>
<p>之後若文章網址邏輯需要修改，則需要到各個 View 中去修改，很容易漏改道造成系統程式出錯</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ $Post-&gt;info-&gt;post_url }}&#34;</span>&gt; {{ $Post-&gt;Title }}&lt;/<span style="color:#f92672">a</span>&gt;
</code></pre></div>




<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1990193713845546"
     data-ad-slot="5417606383"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<footer class="footline">
	
</footer>

        
            </div> 
        
        </div> 
        

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-31063691-12', 'auto');
	
	ga('send', 'pageview');
}
</script>






<div class="notices note">
  <p>KeJyun 最新新書推薦
    <br /> - Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站
    <br /> - Laravel框架开发详解：从零基础到运用框架快速开发PHP网站
  </p>
</div>


<table>
    <tr>
        <td colspan="2">
            <p>Laravel 是 PHP 的框架（Framework），提供了很多開發網站或 API 所需的工具及環境，經過簡單的設定就可以完成資料的處理及顯示，使開發者可以很優雅且快速的開發出各個不同的產品。本書適合有
                PHP 基礎的人，但不知道要怎麼選擇框架，或者不用框架的人也能夠明白它的好處。</p>
            <p>雖然 WordPress 也能夠架站，但如果有客製化需求，要開發各式各樣的網站，或提供 App 使用的 API，如此一來你只能選擇用框架，而 Laravel 是目前最受歡迎的。</p>
            <p>本書將解說為什麼要使用框架，以及理解框架的優缺點後，要怎麼選擇框架，並用框架快速建構一個網站。除非必要，否則書中會避免專業技術用語，盡量使用最生活化易懂的例子及語氣，讓大家更容易進入 Laravel 的世界。</p>
        </td>
    </tr>
    <tr>
        <td style="width:30%;">
            <img src="https://i.imgur.com/RYcmwgY.png"
                 alt="Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站"
            />
        </td>
        <td>
            <h3 style="font-size:16px;">
                購書連結
            </h3>
            <ul>
                <li>
                    <a href="https://goo.gl/Juv97M"
                       target="_blank"
                       alt="博客來-Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站"
                    >
                        博客來
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/fa5dWf"
                       target="_blank"
                       alt="天瓏網路書店-Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站"
                    >
                        天瓏網路書店
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/Ym73kH"
                       target="_blank"
                       alt="Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站-金石堂網路書店"
                    >
                        金石堂網路書店
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/hMnBCs"
                       target="_blank"
                       alt="Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站- TAAZE 讀冊生活"
                    >
                        TAAZE 讀冊生活
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/QiRqXo"
                       target="_blank"
                       alt="Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站 - PChome 24h書店"
                    >
                        PCHome 24h書店
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/nGhPnU"
                       target="_blank"
                       alt="Laravel 5 for beginner 新手道場－－優雅運用框架快速開發 PHP 網站"
                    >
                        商務印書館網上書店
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/RptkyY"
                       target="_blank"
                       alt="Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站-洪可郡 - 三民網路書店"
                    >
                        三民網路書店
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/5dXGQ8"
                       target="_blank"
                       alt="Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站, 城邦阅读花园 - 马来西亚最大网路书店"
                    >
                        城邦阅读花园
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/6Zy8yK"
                       target="_blank"
                       alt="華文網網路書店：Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站．電腦與網路/程式語言◎知．識．服．務．新．思．路◎"
                    >
                        華文網網路書店
                    </a>
                </li>
                <li>
                    <a href="https://goo.gl/o9msPz"
                       target="_blank"
                       alt="新絲路網路書店-Laravel 5 for beginner 新手道場：優雅運用框架快速開發 PHP 網站．電腦與網路/程式語言"
                    >
                        新絲路網路書店
                    </a>
                </li>
            </ul>
        </td>
    </tr>
    <tr>
        <td style="width:30%;">
            <img src="https://i.imgur.com/CurSW2g.jpg"
                 alt="Laravel框架开发详解：从零基础到运用框架快速开发PHP网站"
            />
        </td>
        <td>
            <h3 style="font-size:16px;">
                購書連結
            </h3>
            <ul>
                <li>
                    <a href="http://bit.ly/2EneIxw"
                       target="_blank"
                       alt="《Laravel框架开发详解：从零基础到运用框架快速开发PHP网站》(洪可郡（KeJyun）)【摘要 书评 试读】- 京东图书"
                    >
                        北京大学出版社
                    </a>
                </li>
                <li>
                    <a href="http://bit.ly/2zSxOI2"
                       target="_blank"
                       alt="天瓏網路書店-Laravel框架開發詳解：從零基礎到運用框架快速開發PHP網站"
                    >
                        天瓏網路書店
                    </a>
                </li>
                <li>
                    <a href="https://amzn.to/2RKeN1y"
                       target="_blank"
                       alt="《Laravel框架开发详解:从零基础到运用框架快速开发PHP网站》 洪可郡 (KeJyun)【摘要 书评 试读】图书"
                    >
                        Amazon
                    </a>
                </li>
                <li>
                    <a href="http://bit.ly/2ru0qmu"
                       target="_blank"
                       alt="《正版全新 Laravel框架开发详解：从零基础到运用框架快速开发PHP网站 洪可郡 北京大学出版社》【摘要 书评 试读】- 京东图书"
                    >
                        蓝墨水图书专营店
                    </a>
                </li>
                <li>
                    <a href="http://bit.ly/2Qnrjao"
                       target="_blank"
                       alt="正版 Laravel框架开发详解：从零基础到运用框架快速开发PHP网站 计算机与互联网 网页制作 Web技术 程序设计 洪可郡-tmall.com天猫"
                    >
                        天猫
                    </a>
                </li>
                <li>
                    <a href="http://bit.ly/2PstkNn"
                       target="_blank"
                       alt="Laravel框架開發詳解：從零基礎到運用框架快速開發PHP網站（簡體書）-洪可郡 - 三民網路書店"
                    >
                        三民網路書店
                    </a>
                </li>
                <li>
                    <a href="http://bit.ly/2E7jbnk"
                       target="_blank"
                       alt="博客來-Laravel框架開發詳解：從零基礎到運用框架快速開發PHP網站"
                    >
                        博客來
                    </a>
                </li>
            </ul>
        </td>
    </tr>
</table>



<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "laravel-5-learning-notes" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/structure/service-repository-structure-principle/" title="Service &amp; Repository 架構設計準則（2017 年版本）"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/package/" title="套件" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1615475347"></script>
    <script src="/js/perfect-scrollbar.min.js?1615475347"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1615475347"></script>
    <script src="/js/jquery.sticky.js?1615475347"></script>
    <script src="/js/featherlight.min.js?1615475347"></script>
    <script src="/js/highlight.pack.js?1615475347"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1615475347"></script>
    <script src="/js/learn.js?1615475347"></script>
    <script src="/js/hugo-learn.js?1615475347"></script>

    <link href="/mermaid/mermaid.css?1615475347" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1615475347"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
  </body>
</html>

